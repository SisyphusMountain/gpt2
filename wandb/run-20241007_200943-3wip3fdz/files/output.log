2024-10-07 20:09:43,683 - INFO - Enabling compilation
2024-10-07 20:09:44,980 - INFO - used cuda memory after creating model: 552298496
Number of decayed parameter tensors 50 for a total of 124354560 parameters
Number of non-decayed parameter tensors 98 for a total of 121344 parameters
2024-10-07 20:09:45,810 - INFO - total desired batch size: 524288
2024-10-07 20:09:45,810 - INFO - => computed gradient accumulation steps 32
2024-10-07 20:09:45,811 - INFO - Starting epoch 0
W1007 20:10:08.084000 136414923826368 torch/_logging/_internal.py:1034] [6/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
2024-10-07 20:10:08,274 - INFO - tokens per second = 23340 | loss: 11.003759 | gradient norm 0.1769 | dt 22463.100195 ms | CUDA memory: 526.96 MB | CPU memory: 1.93 GB
2024-10-07 20:10:12,437 - INFO - tokens per second = 126054 | loss: 10.985007 | gradient norm 0.1969 | dt 4159.239769 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:10:16,472 - INFO - tokens per second = 129944 | loss: 10.947857 | gradient norm 0.1736 | dt 4034.727812 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:10:20,511 - INFO - tokens per second = 129796 | loss: 10.899331 | gradient norm 0.1737 | dt 4039.324522 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:10:24,559 - INFO - tokens per second = 129537 | loss: 10.825503 | gradient norm 0.1774 | dt 4047.390699 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:10:28,607 - INFO - tokens per second = 129521 | loss: 10.745281 | gradient norm 0.1761 | dt 4047.899961 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:10:32,655 - INFO - tokens per second = 129506 | loss: 10.659928 | gradient norm 0.1509 | dt 4048.364401 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:10:36,707 - INFO - tokens per second = 129380 | loss: 10.574692 | gradient norm 0.1392 | dt 4052.314997 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:10:40,761 - INFO - tokens per second = 129326 | loss: 10.489209 | gradient norm 0.1204 | dt 4053.992987 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:10:44,815 - INFO - tokens per second = 129339 | loss: 10.405845 | gradient norm 0.1169 | dt 4053.599834 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:10:48,870 - INFO - tokens per second = 129297 | loss: 10.329348 | gradient norm 0.1113 | dt 4054.906845 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:10:52,925 - INFO - tokens per second = 129296 | loss: 10.263943 | gradient norm 0.1059 | dt 4054.938793 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:10:56,983 - INFO - tokens per second = 129177 | loss: 10.201903 | gradient norm 0.1048 | dt 4058.676958 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:11:01,044 - INFO - tokens per second = 129131 | loss: 10.144258 | gradient norm 0.0984 | dt 4060.123682 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:11:05,103 - INFO - tokens per second = 129155 | loss: 10.062038 | gradient norm 0.0955 | dt 4059.375286 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:11:09,166 - INFO - tokens per second = 129027 | loss: 10.012427 | gradient norm 0.0900 | dt 4063.410282 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:11:13,223 - INFO - tokens per second = 129230 | loss: 9.966649 | gradient norm 0.1101 | dt 4057.018042 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:11:17,289 - INFO - tokens per second = 128963 | loss: 9.915791 | gradient norm 0.0824 | dt 4065.427065 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:11:21,354 - INFO - tokens per second = 128982 | loss: 9.920233 | gradient norm 0.0838 | dt 4064.816713 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:11:25,419 - INFO - tokens per second = 128977 | loss: 9.890173 | gradient norm 0.0754 | dt 4064.967871 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:11:29,485 - INFO - tokens per second = 128942 | loss: 9.799018 | gradient norm 0.0735 | dt 4066.083908 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:11:33,550 - INFO - tokens per second = 128954 | loss: 9.746881 | gradient norm 0.1361 | dt 4065.687895 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:11:37,612 - INFO - tokens per second = 129093 | loss: 9.735940 | gradient norm 0.0726 | dt 4061.308384 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:11:41,677 - INFO - tokens per second = 128953 | loss: 9.713408 | gradient norm 0.0680 | dt 4065.719843 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:11:45,745 - INFO - tokens per second = 128881 | loss: 9.667569 | gradient norm 0.0685 | dt 4068.000555 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:11:49,812 - INFO - tokens per second = 128924 | loss: 9.651250 | gradient norm 0.0689 | dt 4066.642284 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:11:53,878 - INFO - tokens per second = 128932 | loss: 9.634763 | gradient norm 0.0705 | dt 4066.383362 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:11:57,948 - INFO - tokens per second = 128839 | loss: 9.601379 | gradient norm 0.0740 | dt 4069.331884 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:12:02,010 - INFO - tokens per second = 129054 | loss: 9.580167 | gradient norm 0.0685 | dt 4062.555313 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:12:06,076 - INFO - tokens per second = 128947 | loss: 9.546380 | gradient norm 0.0701 | dt 4065.914631 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:12:10,144 - INFO - tokens per second = 128914 | loss: 9.566911 | gradient norm 0.0674 | dt 4066.949368 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:12:14,211 - INFO - tokens per second = 128881 | loss: 9.518847 | gradient norm 0.0662 | dt 4068.013668 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:12:18,278 - INFO - tokens per second = 128911 | loss: 9.513603 | gradient norm 0.0659 | dt 4067.044497 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:12:22,344 - INFO - tokens per second = 128939 | loss: 9.474473 | gradient norm 0.0690 | dt 4066.161871 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:12:26,416 - INFO - tokens per second = 128769 | loss: 9.412336 | gradient norm 0.0666 | dt 4071.528196 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:12:30,486 - INFO - tokens per second = 128831 | loss: 9.442009 | gradient norm 0.0680 | dt 4069.581032 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:12:34,554 - INFO - tokens per second = 128850 | loss: 9.427525 | gradient norm 0.0642 | dt 4068.985462 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:12:38,622 - INFO - tokens per second = 128903 | loss: 9.382912 | gradient norm 0.0710 | dt 4067.321301 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:12:42,684 - INFO - tokens per second = 129054 | loss: 9.358426 | gradient norm 0.0643 | dt 4062.534571 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:12:46,752 - INFO - tokens per second = 128903 | loss: 9.359514 | gradient norm 0.0702 | dt 4067.291737 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:12:50,820 - INFO - tokens per second = 128858 | loss: 9.347066 | gradient norm 0.0656 | dt 4068.716526 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:12:54,889 - INFO - tokens per second = 128848 | loss: 9.275373 | gradient norm 0.0760 | dt 4069.052935 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:12:58,957 - INFO - tokens per second = 128887 | loss: 9.265030 | gradient norm 0.0679 | dt 4067.803621 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:13:03,025 - INFO - tokens per second = 128878 | loss: 9.272415 | gradient norm 0.0649 | dt 4068.084478 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:13:07,091 - INFO - tokens per second = 128948 | loss: 9.239302 | gradient norm 0.0622 | dt 4065.900564 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:13:11,159 - INFO - tokens per second = 128886 | loss: 9.227354 | gradient norm 0.0645 | dt 4067.830324 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:13:15,227 - INFO - tokens per second = 128872 | loss: 9.183174 | gradient norm 0.0700 | dt 4068.295002 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:13:19,296 - INFO - tokens per second = 128868 | loss: 9.163229 | gradient norm 0.0596 | dt 4068.419456 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:13:23,363 - INFO - tokens per second = 128895 | loss: 9.144734 | gradient norm 0.0620 | dt 4067.568302 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:13:27,431 - INFO - tokens per second = 128900 | loss: 9.086851 | gradient norm 0.0621 | dt 4067.416430 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:13:31,496 - INFO - tokens per second = 128970 | loss: 9.100094 | gradient norm 0.0642 | dt 4065.180063 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:13:35,561 - INFO - tokens per second = 128981 | loss: 9.055518 | gradient norm 0.0642 | dt 4064.833879 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:13:39,627 - INFO - tokens per second = 128931 | loss: 9.028809 | gradient norm 0.0612 | dt 4066.418648 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:13:43,693 - INFO - tokens per second = 128940 | loss: 8.996412 | gradient norm 0.0591 | dt 4066.124678 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:13:47,763 - INFO - tokens per second = 128824 | loss: 8.992073 | gradient norm 0.0619 | dt 4069.811344 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:13:51,829 - INFO - tokens per second = 128932 | loss: 8.957651 | gradient norm 0.0563 | dt 4066.391945 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:13:55,897 - INFO - tokens per second = 128896 | loss: 8.924764 | gradient norm 0.0534 | dt 4067.534447 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:13:59,965 - INFO - tokens per second = 128879 | loss: 8.905659 | gradient norm 0.0533 | dt 4068.065643 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:14:04,034 - INFO - tokens per second = 128854 | loss: 8.866251 | gradient norm 0.0552 | dt 4068.853378 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:14:08,106 - INFO - tokens per second = 128754 | loss: 8.840503 | gradient norm 0.0595 | dt 4072.000265 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:14:12,171 - INFO - tokens per second = 128981 | loss: 8.818869 | gradient norm 0.0549 | dt 4064.846277 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:14:16,235 - INFO - tokens per second = 128989 | loss: 8.804689 | gradient norm 0.0578 | dt 4064.608335 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:14:20,303 - INFO - tokens per second = 128885 | loss: 8.733616 | gradient norm 0.0527 | dt 4067.863464 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:14:24,372 - INFO - tokens per second = 128848 | loss: 8.704590 | gradient norm 0.0499 | dt 4069.032669 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:14:28,440 - INFO - tokens per second = 128893 | loss: 8.665091 | gradient norm 0.0527 | dt 4067.630529 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:14:32,508 - INFO - tokens per second = 128882 | loss: 8.645401 | gradient norm 0.0556 | dt 4067.955971 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:14:36,574 - INFO - tokens per second = 128953 | loss: 8.599476 | gradient norm 0.0545 | dt 4065.725088 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:14:40,639 - INFO - tokens per second = 128973 | loss: 8.585981 | gradient norm 0.0513 | dt 4065.083265 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:14:44,836 - INFO - tokens per second = 124920 | loss: 8.557032 | gradient norm 0.0557 | dt 4196.986437 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:14:48,945 - INFO - tokens per second = 127593 | loss: 8.478976 | gradient norm 0.0570 | dt 4109.057188 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:14:53,065 - INFO - tokens per second = 127241 | loss: 8.447705 | gradient norm 0.0504 | dt 4120.418072 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:14:57,132 - INFO - tokens per second = 128921 | loss: 8.453294 | gradient norm 0.0465 | dt 4066.747665 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:15:01,195 - INFO - tokens per second = 129043 | loss: 8.386031 | gradient norm 0.0503 | dt 4062.903881 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:15:05,256 - INFO - tokens per second = 129111 | loss: 8.349398 | gradient norm 0.0545 | dt 4060.761690 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:15:09,319 - INFO - tokens per second = 129014 | loss: 8.312295 | gradient norm 0.0480 | dt 4063.792467 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:15:13,385 - INFO - tokens per second = 128942 | loss: 8.313540 | gradient norm 0.0428 | dt 4066.070795 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:15:17,452 - INFO - tokens per second = 128940 | loss: 8.254776 | gradient norm 0.0454 | dt 4066.143751 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:15:21,516 - INFO - tokens per second = 128989 | loss: 8.247377 | gradient norm 0.0443 | dt 4064.593554 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:15:25,581 - INFO - tokens per second = 128982 | loss: 8.209411 | gradient norm 0.0444 | dt 4064.807177 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:15:29,648 - INFO - tokens per second = 128917 | loss: 8.161082 | gradient norm 0.0432 | dt 4066.862583 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:15:33,712 - INFO - tokens per second = 128992 | loss: 8.128185 | gradient norm 0.0411 | dt 4064.513445 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:15:37,778 - INFO - tokens per second = 128958 | loss: 8.114151 | gradient norm 0.0399 | dt 4065.584660 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:15:41,844 - INFO - tokens per second = 128938 | loss: 8.060212 | gradient norm 0.0406 | dt 4066.198111 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:15:45,908 - INFO - tokens per second = 129014 | loss: 8.012807 | gradient norm 0.0390 | dt 4063.793421 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:15:49,974 - INFO - tokens per second = 128945 | loss: 7.992446 | gradient norm 0.0371 | dt 4065.966129 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:15:54,041 - INFO - tokens per second = 128917 | loss: 7.947852 | gradient norm 0.0375 | dt 4066.869974 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:15:58,107 - INFO - tokens per second = 128945 | loss: 7.933225 | gradient norm 0.0534 | dt 4065.975666 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:16:02,172 - INFO - tokens per second = 128981 | loss: 7.910081 | gradient norm 0.0471 | dt 4064.846992 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:16:06,482 - INFO - tokens per second = 121626 | loss: 7.893432 | gradient norm 0.0395 | dt 4310.658216 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:16:10,739 - INFO - tokens per second = 123155 | loss: 7.920742 | gradient norm 0.0444 | dt 4257.127762 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:16:14,921 - INFO - tokens per second = 125387 | loss: 7.826763 | gradient norm 0.0463 | dt 4181.375027 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:16:19,156 - INFO - tokens per second = 123803 | loss: 7.820357 | gradient norm 0.0379 | dt 4234.861851 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:16:23,558 - INFO - tokens per second = 119111 | loss: 7.822064 | gradient norm 0.0477 | dt 4401.663303 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:16:27,695 - INFO - tokens per second = 126701 | loss: 7.854094 | gradient norm 0.0348 | dt 4137.978077 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:16:32,081 - INFO - tokens per second = 119558 | loss: 7.860240 | gradient norm 0.0440 | dt 4385.236502 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:16:36,502 - INFO - tokens per second = 118587 | loss: 7.845649 | gradient norm 0.0400 | dt 4421.141624 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 20:16:40,745 - INFO - tokens per second = 123567 | loss: 7.804491 | gradient norm 0.0417 | dt 4242.948771 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
Traceback (most recent call last):
  File "/home/enzo/Documents/gpt2/gpt2_fabric.py", line 302, in <module>
    loss, norm = training_step(x, y)
                 ^^^^^^^^^^^^^^^^^^^
  File "/home/enzo/mambaforge/envs/up_to_date/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 433, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/enzo/Documents/gpt2/gpt2_fabric.py", line 265, in training_step
    @torch.compile(mode="max-autotune", disable=disable_compilation)
  File "/home/enzo/Documents/gpt2/gpt2_fabric.py", line 267, in torch_dynamo_resume_in_training_step_at_267
    optimizer.zero_grad()
  File "/home/enzo/Documents/gpt2/gpt2_fabric.py", line 271, in torch_dynamo_resume_in_training_step_at_271
    loss.backward()
  File "/home/enzo/mambaforge/envs/up_to_date/lib/python3.12/site-packages/torch/nn/utils/clip_grad.py", line 21, in _no_grad_wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/enzo/mambaforge/envs/up_to_date/lib/python3.12/site-packages/torch/nn/utils/clip_grad.py", line 82, in clip_grad_norm_
    clip_coef = max_norm / (total_norm + 1e-6)
                ~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~
  File "/home/enzo/mambaforge/envs/up_to_date/lib/python3.12/site-packages/torch/_tensor.py", line 35, in wrapped
    @functools.wraps(f, assigned=assigned)

KeyboardInterrupt
