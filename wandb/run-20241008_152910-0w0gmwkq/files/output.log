2024-10-08 15:29:11,375 - WARNING - Disabling compilation
2024-10-08 15:29:12,332 - INFO - used cuda memory after creating model: 552298496
Number of decayed parameter tensors 50 for a total of 124354560 parameters
Number of non-decayed parameter tensors 98 for a total of 121344 parameters
2024-10-08 15:29:12,915 - INFO - total desired batch size: 524288
2024-10-08 15:29:12,915 - INFO - => computed gradient accumulation steps 32
2024-10-08 15:29:18,340 - INFO - tokens per second = 96709 | loss: 10.689304 | gradient norm 0.1695 | dt 5421.292782 ms | CUDA memory: 1022.55 MB | CPU memory: 1.98 GB
2024-10-08 15:29:23,559 - INFO - tokens per second = 100471 | loss: 10.671297 | gradient norm 0.1642 | dt 5218.295336 ms | CUDA memory: 1973.05 MB | CPU memory: 2.05 GB
2024-10-08 15:29:28,543 - INFO - tokens per second = 105212 | loss: 10.637421 | gradient norm 0.1894 | dt 4983.176231 ms | CUDA memory: 1973.05 MB | CPU memory: 2.05 GB
2024-10-08 15:29:33,461 - INFO - tokens per second = 106610 | loss: 10.589334 | gradient norm 0.2014 | dt 4917.815685 ms | CUDA memory: 1973.05 MB | CPU memory: 2.05 GB
2024-10-08 15:29:33,461 - INFO - Saving model
2024-10-08 15:29:33,962 - INFO - Model saved
2024-10-08 15:29:35,061 - INFO - Validation loss: 11.398040008544921
2024-10-08 15:29:40,917 - INFO - tokens per second = 70308 | loss: 10.517740 | gradient norm 0.1755 | dt 7457.000256 ms | CUDA memory: 1978.24 MB | CPU memory: 2.24 GB
2024-10-08 15:29:46,059 - INFO - tokens per second = 101969 | loss: 10.433743 | gradient norm 0.1635 | dt 5141.618252 ms | CUDA memory: 1978.24 MB | CPU memory: 2.24 GB
2024-10-08 15:29:51,091 - INFO - tokens per second = 104191 | loss: 10.352445 | gradient norm 0.1519 | dt 5031.999826 ms | CUDA memory: 1978.24 MB | CPU memory: 2.24 GB
2024-10-08 15:29:56,095 - INFO - tokens per second = 104768 | loss: 10.263583 | gradient norm 0.1367 | dt 5004.254818 ms | CUDA memory: 1978.24 MB | CPU memory: 2.24 GB
2024-10-08 15:29:56,095 - INFO - Saving model
2024-10-08 15:29:56,392 - INFO - Model saved
2024-10-08 15:29:57,571 - INFO - Validation loss: 11.031531524658202
2024-10-08 15:30:03,182 - INFO - tokens per second = 73984 | loss: 10.176464 | gradient norm 0.1360 | dt 7086.540222 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:30:08,427 - INFO - tokens per second = 99968 | loss: 10.097478 | gradient norm 0.1203 | dt 5244.560242 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:30:13,323 - INFO - tokens per second = 107066 | loss: 10.020537 | gradient norm 0.1100 | dt 4896.867990 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:30:18,176 - INFO - tokens per second = 108038 | loss: 9.968894 | gradient norm 0.1104 | dt 4852.820396 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:30:18,176 - INFO - Saving model
2024-10-08 15:30:18,489 - INFO - Model saved
2024-10-08 15:30:19,553 - INFO - Validation loss: 10.718254852294923
2024-10-08 15:30:24,876 - INFO - tokens per second = 78246 | loss: 9.897004 | gradient norm 0.1003 | dt 6700.477362 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:30:29,768 - INFO - tokens per second = 107181 | loss: 9.849542 | gradient norm 0.0912 | dt 4891.630888 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:30:34,520 - INFO - tokens per second = 110336 | loss: 9.790249 | gradient norm 0.0942 | dt 4751.734972 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:30:39,429 - INFO - tokens per second = 106821 | loss: 9.731179 | gradient norm 0.0829 | dt 4908.116102 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:30:39,429 - INFO - Saving model
2024-10-08 15:30:39,727 - INFO - Model saved
2024-10-08 15:30:40,939 - INFO - Validation loss: 10.481039428710938
2024-10-08 15:30:46,328 - INFO - tokens per second = 75978 | loss: 9.690364 | gradient norm 0.0852 | dt 6900.531054 ms | CUDA memory: 1978.24 MB | CPU memory: 2.24 GB
2024-10-08 15:30:51,105 - INFO - tokens per second = 109752 | loss: 9.641308 | gradient norm 0.0857 | dt 4777.028084 ms | CUDA memory: 1978.24 MB | CPU memory: 2.24 GB
2024-10-08 15:30:55,911 - INFO - tokens per second = 109107 | loss: 9.605205 | gradient norm 0.0862 | dt 4805.244684 ms | CUDA memory: 1978.24 MB | CPU memory: 2.24 GB
2024-10-08 15:31:00,711 - INFO - tokens per second = 109231 | loss: 9.610126 | gradient norm 0.0768 | dt 4799.793720 ms | CUDA memory: 1978.24 MB | CPU memory: 2.24 GB
2024-10-08 15:31:00,711 - INFO - Saving model
2024-10-08 15:31:01,010 - INFO - Model saved
2024-10-08 15:31:02,073 - INFO - Validation loss: 10.304074096679688
2024-10-08 15:31:07,424 - INFO - tokens per second = 78099 | loss: 9.594158 | gradient norm 0.0720 | dt 6713.105679 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:31:12,143 - INFO - tokens per second = 111083 | loss: 9.490898 | gradient norm 0.0740 | dt 4719.787598 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:31:16,998 - INFO - tokens per second = 108000 | loss: 9.454227 | gradient norm 0.0726 | dt 4854.532242 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:31:21,877 - INFO - tokens per second = 107465 | loss: 9.420215 | gradient norm 0.0725 | dt 4878.675461 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:31:21,877 - INFO - Saving model
2024-10-08 15:31:22,396 - INFO - Model saved
2024-10-08 15:31:23,474 - INFO - Validation loss: 10.178173065185547
2024-10-08 15:31:28,880 - INFO - tokens per second = 74861 | loss: 9.421335 | gradient norm 0.0730 | dt 7003.526211 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:31:33,689 - INFO - tokens per second = 109032 | loss: 9.364508 | gradient norm 0.0727 | dt 4808.557510 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:31:38,581 - INFO - tokens per second = 107177 | loss: 9.363375 | gradient norm 0.0726 | dt 4891.796112 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:31:43,607 - INFO - tokens per second = 104322 | loss: 9.329268 | gradient norm 0.0684 | dt 5025.691986 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:31:43,607 - INFO - Saving model
2024-10-08 15:31:43,901 - INFO - Model saved
2024-10-08 15:31:45,026 - INFO - Validation loss: 10.077232360839844
2024-10-08 15:31:50,647 - INFO - tokens per second = 74460 | loss: 9.285916 | gradient norm 0.0771 | dt 7041.196585 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:31:55,587 - INFO - tokens per second = 106154 | loss: 9.290596 | gradient norm 0.0708 | dt 4938.960791 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:32:00,523 - INFO - tokens per second = 106195 | loss: 9.251650 | gradient norm 0.0655 | dt 4937.044144 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:32:05,404 - INFO - tokens per second = 107415 | loss: 9.273401 | gradient norm 0.0696 | dt 4880.963802 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:32:05,405 - INFO - Saving model
2024-10-08 15:32:05,707 - INFO - Model saved
2024-10-08 15:32:06,847 - INFO - Validation loss: 9.996236419677734
2024-10-08 15:32:12,074 - INFO - tokens per second = 78610 | loss: 9.228262 | gradient norm 0.0687 | dt 6669.507980 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:32:16,838 - INFO - tokens per second = 110047 | loss: 9.221027 | gradient norm 0.0757 | dt 4764.224052 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:32:21,624 - INFO - tokens per second = 109546 | loss: 9.190445 | gradient norm 0.0679 | dt 4786.024809 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:32:26,400 - INFO - tokens per second = 109782 | loss: 9.117839 | gradient norm 0.0693 | dt 4775.703907 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:32:26,400 - INFO - Saving model
2024-10-08 15:32:26,704 - INFO - Model saved
2024-10-08 15:32:27,812 - INFO - Validation loss: 9.914072418212891
2024-10-08 15:32:33,492 - INFO - tokens per second = 73936 | loss: 9.150151 | gradient norm 0.0671 | dt 7091.082811 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:32:38,807 - INFO - tokens per second = 98626 | loss: 9.136375 | gradient norm 0.0720 | dt 5315.912008 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:32:44,099 - INFO - tokens per second = 99076 | loss: 9.100159 | gradient norm 0.0704 | dt 5291.794777 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:32:49,431 - INFO - tokens per second = 98339 | loss: 9.058548 | gradient norm 0.0700 | dt 5331.432819 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:32:49,431 - INFO - Saving model
2024-10-08 15:32:49,747 - INFO - Model saved
2024-10-08 15:32:50,943 - INFO - Validation loss: 9.82046890258789
2024-10-08 15:32:56,792 - INFO - tokens per second = 71223 | loss: 9.064415 | gradient norm 0.0689 | dt 7361.197710 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:33:02,112 - INFO - tokens per second = 98544 | loss: 9.050076 | gradient norm 0.0656 | dt 5320.353031 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:33:07,445 - INFO - tokens per second = 98320 | loss: 9.010841 | gradient norm 0.0774 | dt 5332.492113 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:33:12,778 - INFO - tokens per second = 98303 | loss: 8.951322 | gradient norm 0.0675 | dt 5333.412886 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:33:12,778 - INFO - Saving model
2024-10-08 15:33:13,070 - INFO - Model saved
2024-10-08 15:33:14,264 - INFO - Validation loss: 9.723736572265626
2024-10-08 15:33:19,970 - INFO - tokens per second = 72902 | loss: 8.949725 | gradient norm 0.0631 | dt 7191.674471 ms | CUDA memory: 1978.24 MB | CPU memory: 2.24 GB
2024-10-08 15:33:25,299 - INFO - tokens per second = 98380 | loss: 8.945991 | gradient norm 0.0611 | dt 5329.232216 ms | CUDA memory: 1978.24 MB | CPU memory: 2.24 GB
2024-10-08 15:33:30,606 - INFO - tokens per second = 98785 | loss: 8.940454 | gradient norm 0.0611 | dt 5307.365894 ms | CUDA memory: 1978.24 MB | CPU memory: 2.24 GB
2024-10-08 15:33:35,932 - INFO - tokens per second = 98443 | loss: 8.879920 | gradient norm 0.0703 | dt 5325.826645 ms | CUDA memory: 1978.24 MB | CPU memory: 2.24 GB
2024-10-08 15:33:35,933 - INFO - Saving model
2024-10-08 15:33:36,234 - INFO - Model saved
2024-10-08 15:33:37,408 - INFO - Validation loss: 9.612876892089844
2024-10-08 15:33:43,215 - INFO - tokens per second = 71991 | loss: 8.881577 | gradient norm 0.0622 | dt 7282.733202 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:33:48,498 - INFO - tokens per second = 99235 | loss: 8.835822 | gradient norm 0.0640 | dt 5283.301115 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:33:53,388 - INFO - tokens per second = 107224 | loss: 8.796039 | gradient norm 0.0666 | dt 4889.637232 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:33:58,275 - INFO - tokens per second = 107280 | loss: 8.779088 | gradient norm 0.0633 | dt 4887.104750 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:33:58,275 - INFO - Saving model
2024-10-08 15:33:58,580 - INFO - Model saved
2024-10-08 15:33:59,659 - INFO - Validation loss: 9.492141723632812
2024-10-08 15:34:04,859 - INFO - tokens per second = 79617 | loss: 8.759425 | gradient norm 0.0590 | dt 6585.108280 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:34:09,725 - INFO - tokens per second = 107752 | loss: 8.717662 | gradient norm 0.0599 | dt 4865.679264 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:34:14,584 - INFO - tokens per second = 107898 | loss: 8.697793 | gradient norm 0.0604 | dt 4859.127283 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:34:19,433 - INFO - tokens per second = 108122 | loss: 8.648840 | gradient norm 0.0626 | dt 4849.059820 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:34:19,434 - INFO - Saving model
2024-10-08 15:34:19,730 - INFO - Model saved
2024-10-08 15:34:20,804 - INFO - Validation loss: 9.363460540771484
2024-10-08 15:34:26,048 - INFO - tokens per second = 79271 | loss: 8.662952 | gradient norm 0.0573 | dt 6613.848448 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:34:30,876 - INFO - tokens per second = 108567 | loss: 8.610991 | gradient norm 0.0613 | dt 4829.186201 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:34:35,595 - INFO - tokens per second = 111103 | loss: 8.596498 | gradient norm 0.0548 | dt 4718.937874 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:34:40,315 - INFO - tokens per second = 111076 | loss: 8.575492 | gradient norm 0.0560 | dt 4720.066547 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:34:40,316 - INFO - Saving model
2024-10-08 15:34:40,619 - INFO - Model saved
2024-10-08 15:34:41,679 - INFO - Validation loss: 9.242027282714844
2024-10-08 15:34:46,850 - INFO - tokens per second = 80233 | loss: 8.527372 | gradient norm 0.0576 | dt 6534.605503 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:34:51,569 - INFO - tokens per second = 111112 | loss: 8.504276 | gradient norm 0.0558 | dt 4718.569756 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:34:56,288 - INFO - tokens per second = 111081 | loss: 8.482833 | gradient norm 0.0571 | dt 4719.873905 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:35:01,007 - INFO - tokens per second = 111126 | loss: 8.459696 | gradient norm 0.0599 | dt 4717.960835 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:35:01,007 - INFO - Saving model
2024-10-08 15:35:01,311 - INFO - Model saved
2024-10-08 15:35:02,369 - INFO - Validation loss: 9.098770904541016
2024-10-08 15:35:07,607 - INFO - tokens per second = 79427 | loss: 8.390604 | gradient norm 0.0570 | dt 6600.879431 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:35:12,324 - INFO - tokens per second = 111167 | loss: 8.357882 | gradient norm 0.0539 | dt 4716.206789 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:35:17,043 - INFO - tokens per second = 111083 | loss: 8.333628 | gradient norm 0.0540 | dt 4719.772816 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:35:21,762 - INFO - tokens per second = 111105 | loss: 8.289558 | gradient norm 0.0518 | dt 4718.870878 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:35:21,762 - INFO - Saving model
2024-10-08 15:35:22,062 - INFO - Model saved
2024-10-08 15:35:23,121 - INFO - Validation loss: 8.962474060058593
2024-10-08 15:35:28,383 - INFO - tokens per second = 79189 | loss: 8.276267 | gradient norm 0.0586 | dt 6620.734453 ms | CUDA memory: 1978.24 MB | CPU memory: 2.24 GB
2024-10-08 15:35:33,102 - INFO - tokens per second = 111098 | loss: 8.248602 | gradient norm 0.0564 | dt 4719.156265 ms | CUDA memory: 1978.24 MB | CPU memory: 2.24 GB
2024-10-08 15:35:37,824 - INFO - tokens per second = 111042 | loss: 8.230474 | gradient norm 0.0455 | dt 4721.519232 ms | CUDA memory: 1978.24 MB | CPU memory: 2.24 GB
2024-10-08 15:35:42,543 - INFO - tokens per second = 111082 | loss: 8.160480 | gradient norm 0.0506 | dt 4719.840050 ms | CUDA memory: 1978.24 MB | CPU memory: 2.24 GB
2024-10-08 15:35:42,544 - INFO - Saving model
2024-10-08 15:35:42,844 - INFO - Model saved
2024-10-08 15:35:43,903 - INFO - Validation loss: 8.834584045410157
2024-10-08 15:35:49,378 - INFO - tokens per second = 76712 | loss: 8.130231 | gradient norm 0.0424 | dt 6834.521532 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:35:54,097 - INFO - tokens per second = 111098 | loss: 8.115314 | gradient norm 0.0463 | dt 4719.134331 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:35:58,814 - INFO - tokens per second = 111142 | loss: 8.081403 | gradient norm 0.0515 | dt 4717.277765 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:36:03,535 - INFO - tokens per second = 111055 | loss: 8.029430 | gradient norm 0.0488 | dt 4720.976830 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:36:03,536 - INFO - Saving model
2024-10-08 15:36:03,827 - INFO - Model saved
2024-10-08 15:36:04,885 - INFO - Validation loss: 8.709514617919922
2024-10-08 15:36:10,294 - INFO - tokens per second = 77568 | loss: 7.990102 | gradient norm 0.0467 | dt 6759.057283 ms | CUDA memory: 1978.24 MB | CPU memory: 2.24 GB
2024-10-08 15:36:15,012 - INFO - tokens per second = 111129 | loss: 8.001896 | gradient norm 0.0686 | dt 4717.813492 ms | CUDA memory: 1978.24 MB | CPU memory: 2.24 GB
2024-10-08 15:36:19,840 - INFO - tokens per second = 108603 | loss: 7.936077 | gradient norm 0.0429 | dt 4827.555180 ms | CUDA memory: 1978.24 MB | CPU memory: 2.24 GB
2024-10-08 15:36:24,585 - INFO - tokens per second = 110497 | loss: 7.936234 | gradient norm 0.0441 | dt 4744.802952 ms | CUDA memory: 1978.24 MB | CPU memory: 2.24 GB
2024-10-08 15:36:24,586 - INFO - Saving model
2024-10-08 15:36:24,886 - INFO - Model saved
2024-10-08 15:36:25,975 - INFO - Validation loss: 8.583661651611328
2024-10-08 15:36:31,315 - INFO - tokens per second = 77906 | loss: 7.923835 | gradient norm 0.0467 | dt 6729.769468 ms | CUDA memory: 1978.24 MB | CPU memory: 2.24 GB
2024-10-08 15:36:36,077 - INFO - tokens per second = 110077 | loss: 7.870076 | gradient norm 0.0412 | dt 4762.915611 ms | CUDA memory: 1978.24 MB | CPU memory: 2.24 GB
2024-10-08 15:36:40,854 - INFO - tokens per second = 109752 | loss: 7.810529 | gradient norm 0.0426 | dt 4777.043104 ms | CUDA memory: 1978.24 MB | CPU memory: 2.24 GB
2024-10-08 15:36:45,782 - INFO - tokens per second = 106393 | loss: 7.806023 | gradient norm 0.0437 | dt 4927.855968 ms | CUDA memory: 1978.24 MB | CPU memory: 2.24 GB
2024-10-08 15:36:45,782 - INFO - Saving model
2024-10-08 15:36:46,084 - INFO - Model saved
2024-10-08 15:36:47,252 - INFO - Validation loss: 8.465070343017578
2024-10-08 15:36:52,932 - INFO - tokens per second = 73332 | loss: 7.790758 | gradient norm 0.0395 | dt 7149.467945 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:36:57,740 - INFO - tokens per second = 109027 | loss: 7.734040 | gradient norm 0.0387 | dt 4808.768511 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:37:02,687 - INFO - tokens per second = 105979 | loss: 7.704867 | gradient norm 0.0413 | dt 4947.109461 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:37:07,610 - INFO - tokens per second = 106525 | loss: 7.694398 | gradient norm 0.0356 | dt 4921.744823 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:37:07,610 - INFO - Saving model
2024-10-08 15:37:07,904 - INFO - Model saved
2024-10-08 15:37:09,021 - INFO - Validation loss: 8.357223510742188
2024-10-08 15:37:14,737 - INFO - tokens per second = 73560 | loss: 7.618234 | gradient norm 0.0354 | dt 7127.394915 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:37:19,571 - INFO - tokens per second = 108454 | loss: 7.629291 | gradient norm 0.0568 | dt 4834.205389 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:37:24,672 - INFO - tokens per second = 102772 | loss: 7.626600 | gradient norm 0.0358 | dt 5101.464272 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:37:29,877 - INFO - tokens per second = 100751 | loss: 7.588962 | gradient norm 0.0395 | dt 5203.825235 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:37:29,877 - INFO - Saving model
2024-10-08 15:37:30,174 - INFO - Model saved
2024-10-08 15:37:31,283 - INFO - Validation loss: 8.253407287597657
2024-10-08 15:37:36,821 - INFO - tokens per second = 75487 | loss: 7.605385 | gradient norm 0.0329 | dt 6945.391178 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:37:42,036 - INFO - tokens per second = 100550 | loss: 7.534489 | gradient norm 0.0497 | dt 5214.217186 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:37:47,438 - INFO - tokens per second = 97053 | loss: 7.511897 | gradient norm 0.0323 | dt 5402.091503 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:37:52,807 - INFO - tokens per second = 97642 | loss: 7.509913 | gradient norm 0.0365 | dt 5369.488716 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:37:52,808 - INFO - Saving model
2024-10-08 15:37:53,112 - INFO - Model saved
2024-10-08 15:37:54,282 - INFO - Validation loss: 8.168817138671875
2024-10-08 15:37:59,793 - INFO - tokens per second = 75051 | loss: 7.548444 | gradient norm 0.0279 | dt 6985.729694 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:38:04,615 - INFO - tokens per second = 108721 | loss: 7.525126 | gradient norm 0.0287 | dt 4822.323084 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:38:09,563 - INFO - tokens per second = 105982 | loss: 7.547813 | gradient norm 0.0289 | dt 4946.965456 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:38:14,427 - INFO - tokens per second = 107780 | loss: 7.481166 | gradient norm 0.0366 | dt 4864.408493 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:38:14,427 - INFO - Saving model
2024-10-08 15:38:14,727 - INFO - Model saved
2024-10-08 15:38:15,789 - INFO - Validation loss: 8.094366455078125
2024-10-08 15:38:20,984 - INFO - tokens per second = 79960 | loss: 7.447732 | gradient norm 0.0347 | dt 6556.915522 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:38:25,774 - INFO - tokens per second = 109465 | loss: 7.431877 | gradient norm 0.0270 | dt 4789.565086 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:38:30,692 - INFO - tokens per second = 106584 | loss: 7.437206 | gradient norm 0.0280 | dt 4918.990374 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:38:35,549 - INFO - tokens per second = 107941 | loss: 7.443571 | gradient norm 0.0259 | dt 4857.149601 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:38:35,550 - INFO - Saving model
2024-10-08 15:38:35,842 - INFO - Model saved
2024-10-08 15:38:36,950 - INFO - Validation loss: 8.025357818603515
2024-10-08 15:38:42,101 - INFO - tokens per second = 80021 | loss: 7.400020 | gradient norm 0.0262 | dt 6551.895142 ms | CUDA memory: 1978.24 MB | CPU memory: 2.26 GB
2024-10-08 15:38:46,824 - INFO - tokens per second = 111008 | loss: 7.376004 | gradient norm 0.0306 | dt 4722.965956 ms | CUDA memory: 1978.24 MB | CPU memory: 2.26 GB
2024-10-08 15:38:51,546 - INFO - tokens per second = 111030 | loss: 7.288587 | gradient norm 0.0324 | dt 4722.028971 ms | CUDA memory: 1978.24 MB | CPU memory: 2.26 GB
2024-10-08 15:38:56,374 - INFO - tokens per second = 108594 | loss: 7.336560 | gradient norm 0.0281 | dt 4827.970505 ms | CUDA memory: 1978.24 MB | CPU memory: 2.26 GB
2024-10-08 15:38:56,375 - INFO - Saving model
2024-10-08 15:38:56,684 - INFO - Model saved
2024-10-08 15:38:57,860 - INFO - Validation loss: 7.968408203125
2024-10-08 15:39:03,244 - INFO - tokens per second = 76315 | loss: 7.350234 | gradient norm 0.0266 | dt 6870.076895 ms | CUDA memory: 1978.24 MB | CPU memory: 2.26 GB
2024-10-08 15:39:08,152 - INFO - tokens per second = 106820 | loss: 7.332510 | gradient norm 0.0302 | dt 4908.130646 ms | CUDA memory: 1978.24 MB | CPU memory: 2.26 GB
2024-10-08 15:39:12,992 - INFO - tokens per second = 108324 | loss: 7.268499 | gradient norm 0.0241 | dt 4839.976311 ms | CUDA memory: 1978.24 MB | CPU memory: 2.26 GB
2024-10-08 15:39:17,957 - INFO - tokens per second = 105614 | loss: 7.306371 | gradient norm 0.0257 | dt 4964.212894 ms | CUDA memory: 1978.24 MB | CPU memory: 2.26 GB
2024-10-08 15:39:17,957 - INFO - Saving model
2024-10-08 15:39:18,256 - INFO - Model saved
2024-10-08 15:39:19,407 - INFO - Validation loss: 7.926777648925781
2024-10-08 15:39:25,222 - INFO - tokens per second = 72170 | loss: 7.340090 | gradient norm 0.0330 | dt 7264.592648 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:39:30,194 - INFO - tokens per second = 105438 | loss: 7.279365 | gradient norm 0.0234 | dt 4972.458363 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
2024-10-08 15:39:35,110 - INFO - tokens per second = 106633 | loss: 7.305503 | gradient norm 0.0252 | dt 4916.745424 ms | CUDA memory: 1978.24 MB | CPU memory: 2.25 GB
Traceback (most recent call last):
  File "/home/enzo/Documents/gpt2/gpt2_fabric.py", line 294, in <module>
    loss, norm = training_step(x, y)
                 ^^^^^^^^^^^^^^^^^^^
  File "/home/enzo/Documents/gpt2/gpt2_fabric.py", line 265, in training_step
    norm = torch.nn.utils.clip_grad_norm_(model.parameters(),
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/enzo/mambaforge/envs/up_to_date/lib/python3.12/site-packages/torch/nn/utils/clip_grad.py", line 21, in _no_grad_wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/enzo/mambaforge/envs/up_to_date/lib/python3.12/site-packages/torch/nn/utils/clip_grad.py", line 82, in clip_grad_norm_
    clip_coef = max_norm / (total_norm + 1e-6)
                ~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~
  File "/home/enzo/mambaforge/envs/up_to_date/lib/python3.12/site-packages/torch/_tensor.py", line 35, in wrapped
    @functools.wraps(f, assigned=assigned)

KeyboardInterrupt
