2024-10-07 19:53:14,053 - INFO - tokens per second = 87901 | loss: 10.995326 | gradient norm 0.2077 | dt 5964.504004 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:53:18,050 - INFO - tokens per second = 131198 | loss: 10.953691 | gradient norm 0.1848 | dt 3996.155739 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:53:22,048 - INFO - tokens per second = 131127 | loss: 10.898038 | gradient norm 0.1846 | dt 3998.334408 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:53:26,047 - INFO - tokens per second = 131092 | loss: 10.819593 | gradient norm 0.1922 | dt 3999.400854 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:53:30,053 - INFO - tokens per second = 130885 | loss: 10.731056 | gradient norm 0.1833 | dt 4005.711555 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:53:34,063 - INFO - tokens per second = 130743 | loss: 10.641493 | gradient norm 0.1684 | dt 4010.064363 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:53:38,078 - INFO - tokens per second = 130580 | loss: 10.536097 | gradient norm 0.1492 | dt 4015.085220 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:53:42,096 - INFO - tokens per second = 130486 | loss: 10.437610 | gradient norm 0.1341 | dt 4017.959118 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:53:46,117 - INFO - tokens per second = 130409 | loss: 10.344019 | gradient norm 0.1212 | dt 4020.326614 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:53:50,137 - INFO - tokens per second = 130411 | loss: 10.254341 | gradient norm 0.1160 | dt 4020.276546 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:53:54,157 - INFO - tokens per second = 130402 | loss: 10.195278 | gradient norm 0.1047 | dt 4020.560980 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:53:58,180 - INFO - tokens per second = 130337 | loss: 10.126965 | gradient norm 0.1039 | dt 4022.552490 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:54:02,210 - INFO - tokens per second = 130108 | loss: 10.069324 | gradient norm 0.0981 | dt 4029.635668 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:54:06,243 - INFO - tokens per second = 129978 | loss: 9.988064 | gradient norm 0.0964 | dt 4033.653498 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:54:10,278 - INFO - tokens per second = 129941 | loss: 9.934797 | gradient norm 0.0907 | dt 4034.807444 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:54:14,313 - INFO - tokens per second = 129926 | loss: 9.894341 | gradient norm 0.1089 | dt 4035.290241 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:54:18,350 - INFO - tokens per second = 129876 | loss: 9.845340 | gradient norm 0.0795 | dt 4036.832571 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:54:22,394 - INFO - tokens per second = 129663 | loss: 9.854114 | gradient norm 0.0810 | dt 4043.464184 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:54:26,434 - INFO - tokens per second = 129777 | loss: 9.846947 | gradient norm 0.0727 | dt 4039.902687 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:54:30,473 - INFO - tokens per second = 129778 | loss: 9.732772 | gradient norm 0.0714 | dt 4039.890766 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:54:34,513 - INFO - tokens per second = 129779 | loss: 9.689450 | gradient norm 0.1309 | dt 4039.846182 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:54:38,552 - INFO - tokens per second = 129824 | loss: 9.671855 | gradient norm 0.0689 | dt 4038.460493 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:54:42,593 - INFO - tokens per second = 129732 | loss: 9.659017 | gradient norm 0.0642 | dt 4041.319370 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:54:46,637 - INFO - tokens per second = 129643 | loss: 9.604170 | gradient norm 0.0643 | dt 4044.085979 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:54:50,682 - INFO - tokens per second = 129629 | loss: 9.595263 | gradient norm 0.0662 | dt 4044.522047 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:54:54,727 - INFO - tokens per second = 129609 | loss: 9.576129 | gradient norm 0.0674 | dt 4045.136929 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:54:58,771 - INFO - tokens per second = 129642 | loss: 9.542866 | gradient norm 0.0711 | dt 4044.129133 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:55:02,814 - INFO - tokens per second = 129665 | loss: 9.519759 | gradient norm 0.0659 | dt 4043.401718 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:55:06,861 - INFO - tokens per second = 129543 | loss: 9.486388 | gradient norm 0.0680 | dt 4047.218323 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:55:10,914 - INFO - tokens per second = 129363 | loss: 9.509313 | gradient norm 0.0646 | dt 4052.828074 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:55:14,961 - INFO - tokens per second = 129557 | loss: 9.454315 | gradient norm 0.0639 | dt 4046.775103 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:55:19,009 - INFO - tokens per second = 129526 | loss: 9.456053 | gradient norm 0.0634 | dt 4047.747612 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:55:23,056 - INFO - tokens per second = 129540 | loss: 9.419468 | gradient norm 0.0664 | dt 4047.299623 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:55:27,100 - INFO - tokens per second = 129661 | loss: 9.344188 | gradient norm 0.0633 | dt 4043.533325 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:55:31,147 - INFO - tokens per second = 129530 | loss: 9.383199 | gradient norm 0.0655 | dt 4047.616959 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:55:35,197 - INFO - tokens per second = 129469 | loss: 9.373752 | gradient norm 0.0617 | dt 4049.535275 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:55:39,251 - INFO - tokens per second = 129334 | loss: 9.323583 | gradient norm 0.0681 | dt 4053.757429 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:55:43,299 - INFO - tokens per second = 129494 | loss: 9.305323 | gradient norm 0.0617 | dt 4048.738003 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:55:47,349 - INFO - tokens per second = 129479 | loss: 9.304308 | gradient norm 0.0672 | dt 4049.225092 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:55:51,401 - INFO - tokens per second = 129370 | loss: 9.287254 | gradient norm 0.0627 | dt 4052.622318 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:55:55,455 - INFO - tokens per second = 129330 | loss: 9.213761 | gradient norm 0.0735 | dt 4053.889036 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:55:59,507 - INFO - tokens per second = 129408 | loss: 9.205367 | gradient norm 0.0650 | dt 4051.419020 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:56:03,560 - INFO - tokens per second = 129332 | loss: 9.198086 | gradient norm 0.0626 | dt 4053.806305 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:56:07,610 - INFO - tokens per second = 129467 | loss: 9.180324 | gradient norm 0.0595 | dt 4049.602747 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:56:11,661 - INFO - tokens per second = 129417 | loss: 9.168694 | gradient norm 0.0616 | dt 4051.164150 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:56:15,717 - INFO - tokens per second = 129252 | loss: 9.123516 | gradient norm 0.0669 | dt 4056.332827 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:56:19,773 - INFO - tokens per second = 129276 | loss: 9.093812 | gradient norm 0.0564 | dt 4055.564880 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:56:23,828 - INFO - tokens per second = 129285 | loss: 9.077546 | gradient norm 0.0583 | dt 4055.299282 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:56:27,882 - INFO - tokens per second = 129323 | loss: 9.019241 | gradient norm 0.0585 | dt 4054.093599 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:56:31,936 - INFO - tokens per second = 129329 | loss: 9.037638 | gradient norm 0.0603 | dt 4053.894043 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:56:35,992 - INFO - tokens per second = 129264 | loss: 8.989123 | gradient norm 0.0599 | dt 4055.961847 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:56:40,051 - INFO - tokens per second = 129161 | loss: 8.968486 | gradient norm 0.0562 | dt 4059.176445 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:56:44,110 - INFO - tokens per second = 129172 | loss: 8.931887 | gradient norm 0.0547 | dt 4058.836222 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:56:48,169 - INFO - tokens per second = 129163 | loss: 8.926691 | gradient norm 0.0583 | dt 4059.105396 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:56:52,235 - INFO - tokens per second = 128959 | loss: 8.896344 | gradient norm 0.0524 | dt 4065.525055 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:56:56,288 - INFO - tokens per second = 129340 | loss: 8.865321 | gradient norm 0.0493 | dt 4053.560257 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:57:00,345 - INFO - tokens per second = 129252 | loss: 8.845674 | gradient norm 0.0502 | dt 4056.329489 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:57:04,403 - INFO - tokens per second = 129176 | loss: 8.811545 | gradient norm 0.0528 | dt 4058.698893 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:57:08,463 - INFO - tokens per second = 129163 | loss: 8.783671 | gradient norm 0.0577 | dt 4059.106827 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:57:12,521 - INFO - tokens per second = 129178 | loss: 8.764861 | gradient norm 0.0528 | dt 4058.636904 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:57:16,580 - INFO - tokens per second = 129180 | loss: 8.749222 | gradient norm 0.0560 | dt 4058.581352 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:57:20,638 - INFO - tokens per second = 129186 | loss: 8.676070 | gradient norm 0.0495 | dt 4058.402538 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:57:24,698 - INFO - tokens per second = 129155 | loss: 8.650866 | gradient norm 0.0469 | dt 4059.360504 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:57:28,758 - INFO - tokens per second = 129137 | loss: 8.613945 | gradient norm 0.0492 | dt 4059.947491 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:57:32,816 - INFO - tokens per second = 129193 | loss: 8.592503 | gradient norm 0.0517 | dt 4058.184385 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:57:36,872 - INFO - tokens per second = 129257 | loss: 8.552746 | gradient norm 0.0503 | dt 4056.165934 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:57:40,927 - INFO - tokens per second = 129289 | loss: 8.538925 | gradient norm 0.0470 | dt 4055.163622 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:57:45,113 - INFO - tokens per second = 125254 | loss: 8.518436 | gradient norm 0.0517 | dt 4185.799599 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:57:49,218 - INFO - tokens per second = 127709 | loss: 8.442324 | gradient norm 0.0527 | dt 4105.334520 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:57:53,314 - INFO - tokens per second = 128004 | loss: 8.410994 | gradient norm 0.0478 | dt 4095.867872 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:57:57,388 - INFO - tokens per second = 128697 | loss: 8.415535 | gradient norm 0.0432 | dt 4073.816299 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:58:01,440 - INFO - tokens per second = 129371 | loss: 8.352366 | gradient norm 0.0471 | dt 4052.596569 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:58:05,655 - INFO - tokens per second = 124404 | loss: 8.313849 | gradient norm 0.0500 | dt 4214.395523 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:58:09,792 - INFO - tokens per second = 126730 | loss: 8.281626 | gradient norm 0.0418 | dt 4137.037992 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
2024-10-07 19:58:13,893 - INFO - tokens per second = 127826 | loss: 8.282041 | gradient norm 0.0404 | dt 4101.575613 ms | CUDA memory: 1478.46 MB | CPU memory: 1.99 GB
Traceback (most recent call last):
  File "/home/enzo/Documents/gpt2/gpt2_fabric.py", line 310, in <module>
    loss, norm = training_step(x, y)
                 ^^^^^^^^^^^^^^^^^^^
  File "/home/enzo/mambaforge/envs/up_to_date/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 433, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/enzo/Documents/gpt2/gpt2_fabric.py", line 275, in training_step
    @torch.compile(mode="max-autotune", disable=disable_compilation)
  File "/home/enzo/Documents/gpt2/gpt2_fabric.py", line 277, in torch_dynamo_resume_in_training_step_at_277
    optimizer.zero_grad()
  File "/home/enzo/Documents/gpt2/gpt2_fabric.py", line 281, in torch_dynamo_resume_in_training_step_at_281
    loss.backward()
  File "/home/enzo/mambaforge/envs/up_to_date/lib/python3.12/site-packages/torch/nn/utils/clip_grad.py", line 21, in _no_grad_wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/enzo/mambaforge/envs/up_to_date/lib/python3.12/site-packages/torch/nn/utils/clip_grad.py", line 82, in clip_grad_norm_
    clip_coef = max_norm / (total_norm + 1e-6)
                ~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~
  File "/home/enzo/mambaforge/envs/up_to_date/lib/python3.12/site-packages/torch/_tensor.py", line 35, in wrapped
    @functools.wraps(f, assigned=assigned)

KeyboardInterrupt
